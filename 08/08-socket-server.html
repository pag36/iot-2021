
<!DOCTYPE HTML>
<html lang="id" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>10. Socket Server Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../09/09-installasi-iot-platform.html" />
    
    
    <link rel="prev" href="../07/07-socket-client.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Ketik untuk mencari" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Pendahuluan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../00/kontrak.html">
            
                <a href="../00/kontrak.html">
            
                    
                    Kontrak Kuliah
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../0a/0a.pertemuan1.html">
            
                <a href="../0a/0a.pertemuan1.html">
            
                    
                    01. Memahami Konsep dan arsitektur IoT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../0b/0b.pertemuan2.html">
            
                <a href="../0b/0b.pertemuan2.html">
            
                    
                    02. Microcontroller
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../01/01.installasi-dan-konfigurasi.html">
            
                <a href="../01/01.installasi-dan-konfigurasi.html">
            
                    
                    03. Instalasi dan Konfigurasi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../02/02-led.html">
            
                <a href="../02/02-led.html">
            
                    
                    04. LED
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../03/03-dht11.html">
            
                <a href="../03/03-dht11.html">
            
                    
                    05. DHT11
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../04/04-sensor-cahaya.html">
            
                <a href="../04/04-sensor-cahaya.html">
            
                    
                    06. LDR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../05/05-lcd.html">
            
                <a href="../05/05-lcd.html">
            
                    
                    07. LCD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../06/06-uts.html">
            
                <a href="../06/06-uts.html">
            
                    
                    08. UTS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../07/07-socket-client.html">
            
                <a href="../07/07-socket-client.html">
            
                    
                    09. Socket Client
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.12" data-path="08-socket-server.html">
            
                <a href="08-socket-server.html">
            
                    
                    10. Socket Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../09/09-installasi-iot-platform.html">
            
                <a href="../09/09-installasi-iot-platform.html">
            
                    
                    11. Installasi IoT Platform
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../10/10-manjemen-iot-dashboard.html">
            
                <a href="../10/10-manjemen-iot-dashboard.html">
            
                    
                    12. Manajemen IoT Dashboard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../11/11-konfigurasi-smart-device.html">
            
                <a href="../11/11-konfigurasi-smart-device.html">
            
                    
                    13. Konfigurasi Smart Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../12/12-iot-gateway.html">
            
                <a href="../12/12-iot-gateway.html">
            
                    
                    14. Message Broker
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Dipublikasikan dengan GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >10. Socket Server</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="socket-server">Socket Server</h1>
<h1 id="topik-bahasan">Topik Bahasan</h1>
<p>Socket Server</p>
<h2 id="kemampuan-akhir-yang-direncanakan">Kemampuan Akhir yang Direncanakan</h2>
<ul>
<li>Mahasiswa mampu memahami protokol komunikasi socket client TCP/IP</li>
<li>Mahasiswa mampu membuat program komunikasi antara MCU sebagai server socket dan komputer sebagai client socket menggunakan bahasa
pemrograman Python.</li>
<li>Mahasiswa mampu membuat program untuk mendengarkan client (listening) dan menerima data sensor dari MCU ke komputer secara real-time
dengan protokol komunikasi socket TCP/IP</li>
</ul>
<h2 id="teori-singkat">Teori Singkat</h2>
<p>Untuk program socket server sudah dibuat pada pertemuan <a href="../07/07-socket-client.html">sebelumnya</a>, tetapi pada kode socket
tersebut masing sederhana yaitu hanya menerima data dari socket client yang dikirimkan.</p>
<p>Untuk kode socket server akan dibuat agar fungsi-fungsi didalamnya lebih banyak lagi, agar tidak hanya bisa menerima data dari client.</p>
<h2 id="praktikum">Praktikum</h2>
<p>Masih menggunakan kode socket server yang sebelumnya, ubahlah kode pada fungsi <code>run</code> menjadi seperti di bawah ini.</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
            <span class="hljs-keyword">try</span>:
                MESSAGE = input(<span class="hljs-string">&quot;Input response:&quot;</span>)
                conn.send(MESSAGE.encode(<span class="hljs-string">&quot;utf8&quot;</span>))  <span class="hljs-comment"># echo</span>
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                print(e)
                <span class="hljs-keyword">break</span>
            sleep(<span class="hljs-number">0.25</span>)
</code></pre>
<p>Dengan mengubah program tersebut, socket server yang akan kita buat mampu menerima input dari keyboard sehingga dapat dimanfaatkan untuk memasukan perintah pada controller atau ESP8266 yang kita miliki.</p>
<pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Arduino.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ESP8266WiFi.h&gt;</span></span>

<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *ssid = <span class="hljs-string">&quot;####&quot;</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *password = <span class="hljs-string">&quot;####&quot;</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> port = <span class="hljs-number">9001</span>;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *host = <span class="hljs-string">&quot;####&quot;</span>;

WiFiClient client;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">connect_wifi</span><span class="hljs-params">()</span>
</span>{
  Serial.<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Connecting to %s &quot;</span>, ssid);
  WiFi.begin(ssid, password);
  <span class="hljs-keyword">while</span> (WiFi.status() != WL_CONNECTED)
  {
    delay(<span class="hljs-number">500</span>);
    Serial.print(<span class="hljs-string">&quot;.&quot;</span>);
  }
  Serial.println(<span class="hljs-string">&quot; connected&quot;</span>);
  delay(<span class="hljs-number">250</span>);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">connect_server</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">while</span> (!client.connect(host, port))
  {
    Serial.<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n[Connecting to %s ... &quot;</span>, host);
    delay(<span class="hljs-number">1000</span>);
    <span class="hljs-keyword">return</span>;
  }
  Serial.println(<span class="hljs-string">&quot;connected]&quot;</span>);
  delay(<span class="hljs-number">1000</span>);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>
</span>{
  Serial.begin(<span class="hljs-number">115200</span>);
  Serial.println(<span class="hljs-string">&quot;Contoh penggunaan socket client&quot;</span>);
  connect_wifi();
  connect_server();
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">if</span> (client.connected())
  {
    Serial.print(<span class="hljs-string">&quot;[Response:]&quot;</span>);
    String line = client.readStringUntil(<span class="hljs-string">&apos;\n&apos;</span>);
    Serial.println(line);
    <span class="hljs-keyword">if</span> (line.equalsIgnoreCase(<span class="hljs-string">&quot;led-on&quot;</span>))
    {
      pinMode(LED_BUILTIN, HIGH);
      delay(<span class="hljs-number">3000</span>);
      pinMode(LED_BUILTIN, LOW);
    }
  }<span class="hljs-keyword">else</span>{
    connect_server();
  }
  delay(<span class="hljs-number">250</span>);
}
</code></pre>
<p>Kode tersebut mirip dengan kode pada pertemuan sebelumnya, yang perlu dimodifkasi adalah bagian di bawah ini</p>
<pre><code class="lang-cpp"><span class="hljs-keyword">if</span> (line.equalsIgnoreCase(<span class="hljs-string">&quot;led-on&quot;</span>))
    {
      pinMode(BUILTIN_LED, HIGH);
      delay(<span class="hljs-number">3000</span>);
      pinMode(BUILTIN_LED, LOW);
    }
</code></pre>
<p>Fungsi kode di atas digunakan untuk membaca setiap data dari socket server, ketika data tersebut <code>led-on</code> berarti akan
menghidupkan LED bawaan esp8266.</p>
<blockquote>
<p>Silakan tambahkan pengecekan ketika tidak terhubung ke server maka akan reconnect atau mencoba terhubung kembali ke server pada fungsi <code>loop()</code>.</p>
</blockquote>
<h2 id="video-pendukung">Video Pendukung</h2>
<p>
<iframe width="877" height="548" src="https://www.youtube.com/embed/WBk2p4kW5LA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>

<h2 id="tugas">Tugas</h2>
<p>Terdapat sebuah dusun di desa tertentu yang sudah menerapkan IoT, contoh penerapan tersebut di gang-gang ketika sudah
beranjak malam lampu yang terdapat pada gang tersebut akan menyala. Pada dusun tersebut juga terdapat kebun rumah kaca, dimana suhu dan kelembaban sangat diperhatikan untuk menjaga produktivitas sayur-sayur di dalam kebun. Semua sensor yang terdapat pada dusun tersebut juga dapat dipantau dan semua lampu yang terdapat pada gang-gang dapat dinyalakan melalui server, ketika posisi malam maka akan mengirimkan data ke server dan server memerintahkan lampu untuk menyala. Lampu yang digunakan bisa menggunakan LED.</p>
<p>Dari kasus di atas, buat program untuk kebutuhan tersebut baik dari sisi controller (ESP8266) dan dari sisi server. Seperti
biasa untuk output dokumentasikan berupa link video google drive ataupun youtube, selanjutnya sisipkan link tersebut pada
laporan Anda.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> hasil yang cocok "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">Tidak ada hasil yang cocok "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../07/07-socket-client.html" class="navigation navigation-prev " aria-label="Previous page: 09. Socket Client">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../09/09-installasi-iot-platform.html" class="navigation navigation-next " aria-label="Next page: 11. Installasi IoT Platform">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"10. Socket Server","level":"1.12","depth":1,"next":{"title":"11. Installasi IoT Platform","level":"1.13","depth":1,"path":"09/09-installasi-iot-platform.md","ref":"09/09-installasi-iot-platform.md","articles":[]},"previous":{"title":"09. Socket Client","level":"1.11","depth":1,"path":"07/07-socket-client.md","ref":"07/07-socket-client.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"id","gitbook":"*"},"file":{"path":"08/08-socket-server.md","mtime":"2021-05-08T04:06:46.873Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-05-08T04:07:58.835Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

